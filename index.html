<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CortaFácil - Corte e Dobra</title>
    <!-- Link para o seu arquivo CSS. Certifique-se de que 'cortedobra.css' existe e está no mesmo diretório. -->
    <link rel="stylesheet" href="cortedobra.css">
    <!-- Opcional: Link para Font Awesome para ícones, se você for usar -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <header>
        <h1>Corte Dobra</h1>
        <p>Calculadora de Corte, Dobra e Peso de Vergalhões</p>
    </header>

    <main>
        <section class="cliente-info">
            <h2>Dados do Cliente</h2>
            <form id="form-cliente">
                <label>Cliente:</label>
                <input type="text" id="cliente" readonly> <!-- Campo somente leitura -->

                <label>Cód. Cliente:</label>
                <input type="text" id="codCliente" readonly> <!-- Campo somente leitura -->

                <label>Obra:</label>
                <input type="text" id="obra">

                <label>Nº do Pedido:</label>
                <input type="text" id="numPedido"> <!-- Este será preenchido automaticamente ao salvar o orçamento -->
                <!-- Campo oculto para armazenar o ID do orçamento ao carregar para edição -->
                <input type="hidden" id="orcamentoId" value="">

                <label>Recebe Caminhão?</label>
                <select id="recebeCaminhao">
                    <option value="Sim">Sim</option>
                    <option value="Não">Não</option>
                </select>

                <label>Data Desejada:</label>
                <input type="date" id="dataDesejada">
            </form>

            <!-- Campo de Busca de Cliente Existente - MOVIDO PARA AQUI -->
            <div class="form-group search-client-group">
                <label for="buscarCliente">Buscar Cliente Existente:</label>
                <div class="input-button-group">
                    <input type="text" id="buscarCliente" placeholder="Digite nome, código ou documento">
                    <button id="btnBuscarCliente" type="button" class="btn">Buscar</button>
                </div>
            </div>
            <div id="resultadosBuscaCliente" class="lista-resultados">
                <!-- Resultados da busca serão inseridos aqui pelo JavaScript -->
            </div>

            <!-- Botão para abrir a modal de cadastro de cliente - MOVIDO PARA AQUI -->
            <button id="btnAbrirModalCadastroCliente" type="button" class="btn-cliente-action">Cadastrar Novo Cliente</button>

        </section>

        <hr>

        <section class="formulario">
            <h2>Adicionar Peça</h2>
            <form id="form-peca">
                <div class="form-row">
                    <div class="form-group-inline">
                        <label for="tipo">Tipo de Peça:</label>
                        <select id="tipo" required>
                            <option value="varaU">Vara em U</option>
                            <option value="estribo">Estribo</option>
                            <option value="varaReta">Vara Reta</option>
                            <option value="varaL">Vara em L</option>
                        </select>
                    </div>

                    <!-- CAMPO DA BITOLA -->
                    <div class="form-group-inline">
                        <label for="bitola">Bitola (mm):</label>
                        <select id="bitola" required>
                            <option value="4.2">4.2</option>
                            <option value="5.0">5.0</option>
                            <option value="6.3">6.3</option>
                            <option value="8.0">8.0</option>
                            <option value="10.0">10.0</option>
                            <option value="12.5">12.5</option>
                            <option value="16.0">16.0</option>
                            <option value="20.0">20.0</option>
                            <option value="25.0">25.0</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group-inline">
                        <label>Medidas (cm):</label>
                        <!-- NOVO DIV PARA AGRUPAR AS MEDIDAS -->
                        <div class="medidas-group">
                            <input type="number" placeholder="a" id="a" required>
                            <input type="number" placeholder="b" id="b">
                            <input type="number" placeholder="c" id="c">
                        </div>
                    </div>

                    <div class="form-group-inline">
                        <label for="quantidade">Quantidade de Peças:</label>
                        <input type="number" id="quantidade" required>
                    </div>
                </div>

                <button type="submit">Adicionar</button>
            </form>
        </section>

        <section class="resultado">
            <h2>Resumo do Pedido</h2>
            <table id="tabela-resultados">
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Bitola</th>
                        <th>Medidas</th>
                        <th>Qtd</th>
                        <th>Comprimento</th>
                        <th>Peso</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- As linhas da tabela serão inseridas aqui pelo JavaScript -->
                </tbody>
            </table>
            <section id="resumo-bitolas" style="margin-top: 2rem;">
                <h3>Resumo por Bitola</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Bitola</th>
                            <th>Peso Total (kg)</th>
                            <th>Custo Total (R$)</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-resumo-bitolas">
                        <!-- O resumo por bitola será inserido aqui pelo JavaScript -->
                    </tbody>
                </table>

                <p style="margin-top: 1rem;"><strong>Peso Total Geral:</strong> <span
                        id="peso-total-geral">0.00 kg</span></p>
                <p><strong>Custo Total Geral:</strong> <span id="custo-total-geral">R$ 0.00</span></p>
            </section>
        </section>
    </main>

    <section style="margin-top: 30px; text-align: center;">
        <button type="button" id="btnSalvarOrcamento"
            style="padding: 12px 25px; background-color: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1.1em; margin-right: 15px; transition: background-color 0.3s ease;">Salvar
            Orçamento</button>

        <button type="button" id="btnGerarPdf"
            style="padding: 12px 25px; background-color: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1.1em; margin-right: 15px; transition: background-color 0.3s ease;">Gerar
            PDF do Orçamento</button>

        <!-- NOVO BOTÃO: Novo Orçamento -->
        <button type="button" id="btnNovoOrcamento"
            style="padding: 12px 25px; background-color: #ffc107; color: #333; border: none; border-radius: 6px; cursor: pointer; font-size: 1.1em; margin-right: 15px; transition: background-color 0.3s ease; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">Novo Orçamento</button>

        <button type="button" id="btnAbrirModalVisualizarOrcamentos"
            style="padding: 12px 25px; background-color: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1.1em; transition: background-color 0.3s ease;">Visualizar Orçamentos</button>
    </section>

    <!-- Estrutura da Modal de Cadastro de Cliente -->
    <div id="modalCadastroCliente" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeModalCadastroCliente">&times;</span>
            <h2>Cadastrar Novo Cliente</h2>
            <form id="formCadastroCliente">
                <div class="form-group">
                    <label for="nomeCliente">Nome/Razão Social:</label>
                    <input type="text" id="nomeCliente" name="nomeCliente" required>
                </div>

                <!-- Botões de Rádio para Tipo de Pessoa - ESTRUTURA MODIFICADA AQUI -->
                <div class="form-group radio-group-tipo-pessoa">
                    <label>Tipo de Pessoa:</label>
                    <div class="radio-options">
                        <div>
                            <input type="radio" id="radioJuridica" name="tipoPessoa" value="juridica" checked>
                            <label for="radioJuridica">CNPJ</label>
                        </div>
                        <div>
                            <input type="radio" id="radioFisica" name="tipoPessoa" value="fisica">
                            <label for="radioFisica">CPF</label>
                        </div>
                    </div>
                </div>

                <!-- CAMPO CNPJ (Visível por padrão, oculto por JS se for CPF) -->
                <div class="form-group" id="cnpjGroup">
                    <label for="cnpjCliente">CNPJ:</label>
                    <input type="text" id="cnpjCliente" name="cnpjCliente">
                </div>

                <!-- CAMPO CPF (Inicialmente oculto, visível por JS se for CPF) -->
                <div class="form-group" id="cpfGroup" style="display: none;">
                    <label for="cpfCliente">CPF:</label>
                    <input type="text" id="cpfCliente" name="cpfCliente">
                </div>

                <!-- NOVOS CAMPOS DE ENDEREÇO -->
                <div class="form-group">
                    <label for="ruaCliente">Rua:</label>
                    <input type="text" id="ruaCliente" name="ruaCliente" required>
                </div>
                <div class="form-group">
                    <label for="numeroCliente">Número:</label>
                    <input type="text" id="numeroCliente" name="numeroCliente" required>
                </div>
                <div class="form-group">
                    <label for="bairroCliente">Bairro:</label>
                    <input type="text" id="bairroCliente" name="bairroCliente" required>
                </div>
                <div class="form-group">
                    <label for="cidadeCliente">Cidade:</label>
                    <input type="text" id="cidadeCliente" name="cidadeCliente" required>
                </div>
                <div class="form-group">
                    <label for="cepCliente">CEP:</label>
                    <input type="text" id="cepCliente" name="cepCliente" required>
                </div>

                <div class="form-group">
                    <label for="telefoneCliente">Telefone:</label>
                    <input type="text" id="telefoneCliente" name="telefoneCliente" required>
                </div>
                <div class="form-group">
                    <label for="emailCliente">E-mail (opcional):</label>
                    <input type="email" id="emailCliente" name="emailCliente">
                </div>
                <button type="submit">Salvar Cliente</button>
            </form>
            <div id="cadastroClienteFeedback" style="margin-top: 10px; color: green;"></div>
        </div>
    </div>

    <!-- Estrutura da Modal de Visualização de Orçamentos -->
    <div id="modalVisualizarOrcamentos" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeModalVisualizarOrcamentos">&times;</span>
            <h2>Visualizar Orçamentos</h2>
            <div class="form-group">
                <label for="filtroOrcamento">Filtrar por Cliente/Pedido:</label>
                <input type="text" id="filtroOrcamento" placeholder="Digite para filtrar" style="width: calc(100% - 80px);">
                <button id="btnFiltrarOrcamentos" type="button" class="btn" style="
                    padding: 8px 15px;
                    background-color: #17a2b8; /* Azul claro para busca */
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 0.9em;
                    margin-left: 5px;
                    transition: background-color 0.3s ease;
                ">Filtrar</button>
            </div>
            <div id="listaOrcamentos" class="lista-resultados" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; border-radius: 5px; margin-top: 10px;">
                <!-- Orçamentos serão carregados aqui -->
                <p style="text-align: center; color: gray;">Carregando orçamentos...</p>
            </div>
            <div id="visualizarOrcamentoFeedback" style="margin-top: 10px;"></div>
        </div>
    </div>

    <!-- Scripts JavaScript -->
    <!-- jsPDF deve vir primeiro, pois cortedobra.js depende dele -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Seu script principal -->
    <script src="cortedobra.js"></script>

</body>

</html>
