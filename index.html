<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CortaFácil - Corte e Dobra</title>
    <!-- Link para o seu arquivo CSS. Certifique-se de que 'cortedobra.css' existe e está no mesmo diretório. -->
    <link rel="stylesheet" href="cortedobra.css">
    <!-- Opcional: Link para Font Awesome para ícones, se você for usar -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Adiciona um favicon para evitar o erro 404 no console -->
    <link rel="icon" href="https://placehold.co/32x32/007bff/ffffff?text=CF" type="image/x-icon">
</head>

<body>
    <header>
        <h1>Corte Dobra</h1>
        <p>Calculadora de Corte, Dobra e Peso de Vergalhões</p>
    </header>

    <main>
        <section class="cliente-info panel">
            <div class="panel-header">
                <h2>Dados do Cliente</h2>
            </div>
            <div class="panel-content">
                <form id="form-cliente">
                    <div class="form-row-grid">
                        <div class="form-group-grid">
                            <label for="cliente">Cliente:</label>
                            <input type="text" id="cliente" name="cliente" readonly>
                        </div>
                        <div class="form-group-grid">
                            <label for="codCliente">Cód. Cliente:</label>
                            <input type="text" id="codCliente" name="codCliente" readonly>
                        </div>
                    </div>

                    <div class="form-row-grid">
                        <div class="form-group-grid">
                            <label for="obra">Obra:</label>
                            <input type="text" id="obra" name="obra">
                        </div>
                        <div class="form-group-grid">
                            <label for="numPedido">Nº do Pedido:</label>
                            <input type="text" id="numPedido" name="numPedido" readonly>
                            <input type="hidden" id="orcamentoId" name="orcamentoId" value="">
                        </div>
                    </div>

                    <div class="form-row-grid">
                        <div class="form-group-grid">
                            <label for="recebeCaminhao">Recebe Caminhão?</label>
                            <select id="recebeCaminhao" name="recebeCaminhao">
                                <option value="Sim">Sim</option>
                                <option value="Não">Não</option>
                            </select>
                        </div>
                        <div class="form-group-grid">
                            <label for="dataDesejada">Data Deseja:</label>
                            <input type="date" id="dataDesejada" name="dataDesejada">
                        </div>
                    </div>
                </form>

                <!-- Campo de Busca de Cliente Existente -->
                <div class="form-group search-client-group">
                    <label for="buscarCliente">Buscar Cliente Existente:</label>
                    <div class="input-button-group">
                        <input type="text" id="buscarCliente" placeholder="Digite nome, código ou documento">
                        <button id="btnBuscarCliente" type="button" class="btn btn-search"><i class="fas fa-search"></i> Buscar</button>
                    </div>
                </div>
                <div id="resultadosBuscaCliente" class="lista-resultados">
                    <!-- Resultados da busca serão inseridos aqui pelo JavaScript -->
                </div>

                <!-- Botão para abrir a modal de cadastro de cliente -->
                <button id="btnAbrirModalCadastroCliente" type="button" class="btn btn-primary btn-cliente-action"><i class="fas fa-user-plus"></i> Cadastrar Novo Cliente</button>
                <!-- NOVO BOTÃO: Editar Cliente -->
                <button id="btnEditarCliente" type="button" class="btn btn-info btn-cliente-action" style="display: none;"><i class="fas fa-user-edit"></i> Editar Cliente</button>
            </div>
        </section>

        <hr>

        <section class="formulario panel">
            <div class="panel-header">
                <h2>Adicionar Peça</h2>
            </div>
            <div class="panel-content">
                <form id="form-peca">
                    <div class="form-row-grid">
                        <div class="form-group-grid">
                            <label for="tipo">Tipo de Peça:</label>
                            <select id="tipo" name="tipo" required>
                                <option value="varaU">Vara em U</option>
                                <option value="estribo">Estribo</option>
                                <option value="varaReta">Vara Reta</option>
                                <option value="varaL">Vara em L</option>
                            </select>
                        </div>

                        <!-- CAMPO DA BITOLA -->
                        <div class="form-group-grid">
                            <label for="bitola">Bitola (mm):</label>
                            <select id="bitola" name="bitola" required>
                                <option value="4.2">4.2</option>
                                <option value="5.0">5.0</option>
                                <option value="6.3">6.3</option>
                                <option value="8.0">8.0</option>
                                <option value="10.0">10.0</option>
                                <option value="12.5">12.5</option>
                                <option value="16.0">16.0</option>
                                <option value="20.0">20.0</option>
                                <option value="25.0">25.0</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row-grid">
                        <div class="form-group-grid">
                            <label>Medidas (cm):</label>
                            <!-- NOVO DIV PARA AGRUPAR AS MEDIDAS - MAIS COLADINHO -->
                            <div class="medidas-group">
                                <input type="number" placeholder="a" id="a" name="a" required>
                                <input type="number" placeholder="b" id="b" name="b">
                                <input type="number" placeholder="c" id="c" name="c">
                            </div>
                        </div>

                        <div class="form-group-grid">
                            <label for="quantidade">Quantidade de Peças:</label>
                            <input type="number" id="quantidade" name="quantidade" required>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-success"><i class="fas fa-plus-circle"></i> Adicionar</button>
                </form>
            </div>
        </section>

        <section class="resultado panel">
            <div class="panel-header">
                <h2>Resumo do Pedido</h2>
            </div>
            <div class="panel-content">
                <div class="table-responsive">
                    <table id="tabela-resultados">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Bitola</th>
                                <th>Medidas</th>
                                <th>Qtd</th>
                                <th>Comprimento</th>
                                <th>Peso</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- As linhas da tabela serão inseridas aqui pelo JavaScript -->
                        </tbody>
                    </table>
                </div>
                <section id="resumo-bitolas" class="summary-section">
                    <h3>Resumo por Bitola</h3>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Bitola</th>
                                    <th>Peso Total (kg)</th>
                                    <th>Custo Total (R$)</th>
                                </tr>
                            </thead>
                            <tbody id="tabela-resumo-bitolas">
                                <!-- O resumo por bitola será inserido aqui pelo JavaScript -->
                            </tbody>
                        </table>
                    </div>

                    <div class="total-summary">
                        <p><strong>Peso Total Geral:</strong> <span id="peso-total-geral">0.00 kg</span></p>
                        <p><strong>Custo Total Geral:</strong> <span id="custo-total-geral">R$ 0.00</span></p>
                    </div>
                </section>
            </div>
        </section>
    </main>

    <section class="main-actions">
        <button type="button" id="btnSalvarOrcamento" class="btn btn-action btn-save"><i class="fas fa-save"></i> Salvar Orçamento</button>
        <button type="button" id="btnGerarPdf" class="btn btn-action btn-pdf"><i class="fas fa-file-pdf"></i> Gerar PDF do Orçamento</button>
        <button type="button" id="btnNovoOrcamento" class="btn btn-action btn-new"><i class="fas fa-plus-square"></i> Novo Orçamento</button>
        <button type="button" id="btnAbrirModalVisualizarOrcamentos" class="btn btn-action btn-view"><i class="fas fa-eye"></i> Visualizar Orçamentos</button>
    </section>

    <!-- Estrutura da Modal de Cadastro/Edição de Cliente -->
    <div id="modalCadastroCliente" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeModalCadastroCliente">&times;</span>
            <div class="modal-header">
                <h2 id="modalClienteTitle">Cadastrar Novo Cliente</h2>
            </div>
            <div class="modal-body">
                <form id="formCadastroCliente">
                    <input type="hidden" id="clienteIdParaEdicao" name="clienteIdParaEdicao" value="">
                    <div class="form-group">
                        <label for="nomeCliente">Nome/Razão Social:</label>
                        <input type="text" id="nomeCliente" name="nomeCliente" required>
                    </div>

                    <!-- Botões de Rádio para Tipo de Pessoa -->
                    <div class="form-group radio-group-tipo-pessoa">
                        <label>Tipo de Pessoa:</label>
                        <div class="radio-options">
                            <div>
                                <input type="radio" id="radioJuridica" name="tipoPessoa" value="juridica" checked>
                                <label for="radioJuridica">CNPJ</label>
                            </div>
                            <div>
                                <input type="radio" id="radioFisica" name="tipoPessoa" value="fisica">
                                <label for="radioFisica">CPF</label>
                            </div>
                        </div>
                    </div>

                    <!-- CAMPO CNPJ (Visível por padrão, oculto por JS se for CPF) -->
                    <div class="form-group" id="cnpjGroup">
                        <label for="cnpjCliente">CNPJ:</label>
                        <input type="text" id="cnpjCliente" name="cnpjCliente">
                    </div>

                    <!-- CAMPO CPF (Inicialmente oculto, visível por JS se for CPF) -->
                    <div class="form-group" id="cpfGroup" style="display: none;">
                        <label for="cpfCliente">CPF:</label>
                        <input type="text" id="cpfCliente" name="cpfCliente">
                    </div>

                    <div class="form-group">
                        <label for="telefoneCliente">Telefone:</label>
                        <input type="text" id="telefoneCliente" name="telefoneCliente" required>
                    </div>
                    <div class="form-group">
                        <label for="emailCliente">E-mail (opcional):</label>
                        <input type="email" id="emailCliente" name="emailCliente">
                    </div>

                    <h3>Endereços</h3>
                    <div id="enderecosContainer">
                        <!-- Endereços serão adicionados dinamicamente aqui -->
                    </div>
                    <button type="button" id="btnAddEndereco" class="btn btn-secondary"><i class="fas fa-plus"></i> Adicionar Endereço</button>
                    
                    <button type="submit" class="btn btn-success"><i class="fas fa-check-circle"></i> Salvar Cliente</button>
                </form>
                <div id="cadastroClienteFeedback" class="feedback-message"></div>
            </div>
        </div>
    </div>

    <!-- Estrutura da Modal de Visualização de Orçamentos -->
    <div id="modalVisualizarOrcamentos" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeModalVisualizarOrcamentos">&times;</span>
            <div class="modal-header">
                <h2>Visualizar Orçamentos</h2>
            </div>
            <div class="modal-body">
                <div class="form-group search-filter-group">
                    <label for="filtroOrcamento">Filtrar por Cliente/Pedido:</label>
                    <div class="input-button-group">
                        <input type="text" id="filtroOrcamento" placeholder="Digite para filtrar">
                        <button id="btnFiltrarOrcamentos" type="button" class="btn btn-search"><i class="fas fa-filter"></i> Filtrar</button>
                    </div>
                </div>
                <div id="listaOrcamentos" class="lista-resultados">
                    <!-- Orçamentos serão carregados aqui -->
                    <p class="loading-message">Carregando orçamentos...</p>
                </div>
                <div id="visualizarOrcamentoFeedback" class="feedback-message"></div>
            </div>
        </div>
    </div>

    <!-- Scripts JavaScript -->
    <!-- jsPDF deve vir primeiro, pois cortedobra.js depende dele -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Seu script principal -->
    <script src="cortedobra.js"></script>
    

</body>

</html>
